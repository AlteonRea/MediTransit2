<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cardbox Packing</title>
    <link href="./node_modules/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="styles/CardboardPacking.css">
</head>
<body>
    <div class="d-flex flex-column flex-shrink-0 p-3 text-white bg-dark" style="width: 280px; position: fixed; top: 0; bottom: 0; overflow-y: auto;">
        <a href="/" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto text-white text-decoration-none">
            <svg class="bi me-2" width="40" height="32"><use xlink:href="#bootstrap"/></svg>
            <span class="fs-4">MediTransit</span>
        </a>
        <hr>
        <ul class="nav nav-pills flex-column mb-auto">
            <li>
                <a href="#" id="vehicle-link" class="nav-link text-white">
                    <svg class="bi me-2" width="16" height="16"><use xlink:href="#grid"/></svg>
                    Vehicle Packing
                </a>
            </li>
            <li>
                <a href="#" class="nav-link active">
                    <svg class="bi me-2" width="16" height="16"><use xlink:href="#people-circle"/></svg>
                    Cardbox Packing
                </a>
            </li>
        </ul>
        <!-- Dropdown for idDriver selection -->
        <label for="id-driver-select" class="form-label text-white">Select idDriver:</label>
        <select id="id-driver-select" class="form-select">
            <!-- You can populate this dynamically based on your actual idDriver values -->
            <option value="2">Driver 2</option>
            <option value="6">Driver 6</option>
            <!-- Add more options as needed -->
        </select>
        <button id="loadDataBtn" class="btn btn-primary mt-2">Load Data</button>
    </div>

    <div id="container"></div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const idDriverSelect = document.getElementById('id-driver-select');
            const loadDataBtn = document.getElementById('loadDataBtn');

            loadDataBtn.addEventListener('click', function () {
                const selectedIdDriver = idDriverSelect.value;
                const folderName = 'PackingResults';
                const folderPath = `vrp3d/${folderName}/${selectedIdDriver}`;
                const iframeElement = document.getElementById('app-frame');

                function createFileStructure(fileName) {
                    const xDiv = document.createElement('div');
                    xDiv.classList.add('x');

                    const iframeContainer = document.createElement('div');
                    iframeContainer.classList.add('container');

                    const iframe = document.createElement('iframe');
                    iframe.classList.add('app-frame');
                    iframe.src = `${folderPath}/${fileName}`;
                    iframeContainer.appendChild(iframe);

                    xDiv.appendChild(iframeContainer);

                    return xDiv;
                }

                fetch(`/getFileList?idDriver=${selectedIdDriver}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ folderPath }),
                })
                    .then(response => response.json())
                    .then(fileList => {
                        filesList = fileList.files;
                        const mainContainer = document.getElementById('container');

                        for (let i = 0; i < filesList.length; i += 2) {
                            const fileName = filesList[i];
                            const contentFileName = filesList[i + 1];

                            const fileStructure = createFileStructure(fileName);
                            mainContainer.appendChild(fileStructure);
                        }
                    })
                    .catch(error => console.error(error));
            });
        });
    </script>
</body>
</html>
